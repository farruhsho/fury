# SMS Verification Troubleshooting Guide

## Problem: "–ö–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, –Ω–æ SMS –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç

### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è:

## 1. ‚úÖ Firebase Console - Phone Authentication

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- –û—Ç–∫—Ä–æ–π—Ç–µ [Firebase Console](https://console.firebase.google.com/)
- –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç `fury-chat-a5c19`
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Authentication** ‚Üí **Sign-in method**
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ **Phone** –≤–∫–ª—é—á–µ–Ω (enabled)

**–ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å:**
1. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ **Phone**
2. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ **Enable** –≤ ON
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

---

## 2. üì± –§–æ—Ä–º–∞—Ç –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:**
```
+998901234567  ‚úÖ (–£–∑–±–µ–∫–∏—Å—Ç–∞–Ω)
+996501234567  ‚úÖ (–ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω)
+77011234567   ‚úÖ (–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω)
+12025551234   ‚úÖ (–°–®–ê)
```

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:**
```
998901234567   ‚ùå (–±–µ–∑ +)
8901234567     ‚ùå (–±–µ–∑ –∫–æ–¥–∞ —Å—Ç—Ä–∞–Ω—ã)
+998 90 123 45 67  ‚ùå (—Å –ø—Ä–æ–±–µ–ª–∞–º–∏ - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –∏—Ö —É–¥–∞–ª–∏—Ç—å)
```

---

## 3. üîê SHA-256 Certificate Fingerprint (—Ç–æ–ª—å–∫–æ Android)

–î–ª—è Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π Firebase —Ç—Ä–µ–±—É–µ—Ç SHA-256 —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–ª—è Phone Auth.

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ Firebase Console ‚Üí Project Settings
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Your apps**
3. –í—ã–±–µ—Ä–∏—Ç–µ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ **SHA certificate fingerprints**

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å SHA-256:**

**Debug certificate (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏):**
```bash
# Windows
cd C:\Users\YOUR_USERNAME\.android
keytool -list -v -keystore debug.keystore -alias androiddebugkey -storepass android -keypass android

# macOS/Linux
keytool -list -v -keystore ~/.android/debug.keystore -alias androiddebugkey -storepass android -keypass android
```

**Release certificate (–¥–ª—è production):**
```bash
keytool -list -v -keystore your-release-key.keystore -alias your-alias
```

**–î–æ–±–∞–≤–∏—Ç—å –≤ Firebase:**
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ SHA-256 fingerprint
2. Firebase Console ‚Üí Project Settings ‚Üí Your apps ‚Üí Android app
3. –ù–∞–∂–º–∏—Ç–µ **Add fingerprint**
4. –í—Å—Ç–∞–≤—å—Ç–µ SHA-256
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

**–í–ê–ñ–ù–û:** –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è SHA-256, —Å–∫–∞—á–∞–π—Ç–µ –Ω–æ–≤—ã–π `google-services.json` –∏ –∑–∞–º–µ–Ω–∏—Ç–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ:
```
android/app/google-services.json
```

---

## 4. üí∞ Firebase SMS Quota

Firebase –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω (Spark) –∏–º–µ–µ—Ç –ª–∏–º–∏—Ç—ã –Ω–∞ SMS.

**–õ–∏–º–∏—Ç—ã Spark Plan:**
- 10 SMS –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–π –≤ –¥–µ–Ω—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- –û–±—â–∏–π –ª–∏–º–∏—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–≥–∏–æ–Ω–∞

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. Firebase Console ‚Üí Usage and billing
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ **Authentication** usage
3. –ï—Å–ª–∏ –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç - –æ–±–Ω–æ–≤–∏—Ç–µ –¥–æ Blaze Plan (pay-as-you-go)

**–°—Ç–æ–∏–º–æ—Å—Ç—å SMS (Blaze Plan):**
- –°–®–ê/–ö–∞–Ω–∞–¥–∞: ~$0.01 –∑–∞ SMS
- –î—Ä—É–≥–∏–µ —Å—Ç—Ä–∞–Ω—ã: ~$0.015-0.03 –∑–∞ SMS

---

## 5. üß™ Test Phone Numbers (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

–í–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω—ã—Ö SMS, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –Ω–æ–º–µ—Ä–∞.

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**
1. Firebase Console ‚Üí Authentication ‚Üí Sign-in method
2. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ –¥–æ **Phone numbers for testing**
3. –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–æ–º–µ—Ä –∏ –∫–æ–¥:

–ü—Ä–∏–º–µ—Ä:
```
Phone number: +998901234567
Verification code: 123456
```

4. –¢–µ–ø–µ—Ä—å –¥–ª—è —ç—Ç–æ–≥–æ –Ω–æ–º–µ—Ä–∞ SMS –Ω–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è, –Ω–æ –∫–æ–¥ `123456` –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

---

## 6. üåç –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Å—Ç—Ä–∞–Ω—ã –º–æ–≥—É—Ç –∏–º–µ—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π SMS —á–µ—Ä–µ–∑ Firebase.

**–†–µ—à–µ–Ω–∏—è:**
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ SMS –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (Twilio, AWS SNS)
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ VPN –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
3. –î–æ–±–∞–≤—å—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –≤—Ö–æ–¥–∞ (Email, Google Sign-In)

---

## 7. üìä –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞

–Ø –¥–æ–±–∞–≤–∏–ª –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥. –¢–µ–ø–µ—Ä—å –≤ –∫–æ–Ω—Å–æ–ª–∏ –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
üîµ [SMS] Starting phone verification for: +998901234567
üì§ [SMS] Code sent callback triggered - VerificationID: xxx
‚úÖ [SMS] Verification ID received successfully: xxx
```

**–ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∞:**
```
‚ùå [SMS] Verification failed - Code: invalid-phone-number, Message: The format of the phone number provided is incorrect
```

**–ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏:**

**Flutter Debug Console:**
```bash
flutter run
# –õ–æ–≥–∏ –±—É–¥—É—Ç –≤ –∫–æ–Ω—Å–æ–ª–∏
```

**Android Logcat:**
```bash
adb logcat | grep "SMS"
```

**iOS Console:**
```bash
# –í Xcode: View ‚Üí Debug Area ‚Üí Activate Console
```

---

## 8. üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞

**–§–∞–π–ª:** `lib/features/auth/data/datasources/auth_remote_datasource.dart:18`

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ:
1. `FirebaseAuth.instance` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
2. `Firebase.initializeApp()` –≤—ã–∑–≤–∞–Ω –≤ `main.dart`
3. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π `google-services.json` (Android) / `GoogleService-Info.plist` (iOS)

---

## –ü–æ—à–∞–≥–æ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥

```bash
flutter run
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏

–°–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `[SMS]`

### –®–∞–≥ 3: –û–±—â–∏–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

| –ö–æ–¥ –æ—à–∏–±–∫–∏ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|------------|---------|---------|
| `invalid-phone-number` | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç | –î–æ–±–∞–≤—å—Ç–µ –∫–æ–¥ —Å—Ç—Ä–∞–Ω—ã (+998...) |
| `missing-phone-number` | –ù–æ–º–µ—Ä –Ω–µ —É–∫–∞–∑–∞–Ω | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –Ω–æ–º–µ—Ä –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è |
| `quota-exceeded` | –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç SMS | –ü–æ–¥–æ–∂–¥–∏—Ç–µ –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç–µ –ø–ª–∞–Ω |
| `app-not-authorized` | SHA-256 –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω | –î–æ–±–∞–≤—å—Ç–µ SHA fingerprint (Android) |
| `network-request-failed` | –ù–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ |
| `too-many-requests` | –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫ | –ü–æ–¥–æ–∂–¥–∏—Ç–µ 1-2 –º–∏–Ω—É—Ç—ã |

---

## –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - Checklist:

- [ ] Phone Authentication –≤–∫–ª—é—á–µ–Ω –≤ Firebase Console
- [ ] –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ +[–∫–æ–¥ —Å—Ç—Ä–∞–Ω—ã][–Ω–æ–º–µ—Ä]
- [ ] SHA-256 –¥–æ–±–∞–≤–ª–µ–Ω –≤ Firebase (—Ç–æ–ª—å–∫–æ Android)
- [ ] `google-services.json` / `GoogleService-Info.plist` –∞–∫—Ç—É–∞–ª—å–Ω—ã
- [ ] –ù–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∞ –∫–≤–æ—Ç–∞ SMS
- [ ] –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω
- [ ] Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –≤ `main.dart`
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –ª–æ–≥–∏ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `[SMS]`

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏:

**Firebase Support:**
- [Firebase Documentation - Phone Auth](https://firebase.google.com/docs/auth/flutter/phone-auth)
- [Firebase Support](https://firebase.google.com/support)

**Flutter Firebase:**
- [FlutterFire Documentation](https://firebase.flutter.dev/)
- [GitHub Issues](https://github.com/firebase/flutterfire/issues)

---

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–∞–µ—Ç—Å—è:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Email Authentication –≤–º–µ—Å—Ç–æ Phone**
2. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ Twilio –¥–ª—è SMS** (–±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ)
3. **–î–æ–±–∞–≤—å—Ç–µ Google Sign-In** (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç SMS)
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –Ω–æ–º–µ—Ä–∞** (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
